package com.qingqing.test.service.pay.impl;

import com.qingqing.common.util.JsonUtil;
import com.qingqing.test.bean.common.response.ListResponse;
import com.qingqing.test.bean.common.response.SingleResponse;
import com.qingqing.test.client.ApiPiClient;
import com.qingqing.test.domain.pay.ThirdPayBrief;
import com.qingqing.test.service.pay.ThirdPayBriefService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Component;

import java.util.List;

/**
 * Created by zhujianxing on 2018/2/12.
 */
@Component
public class ThirdPayBriefServiceImpl implements ThirdPayBriefService {

    @Autowired
    private ApiPiClient apiPiClient;

    @Override
    public List<ThirdPayBrief> selectListByOrderTypeAndOrderId(Integer orderType, Long orderId) {
        ListResponse<ThirdPayBrief> payBriefListResponse =  apiPiClient.getThirdPayBriefList(orderId, orderType);
        return payBriefListResponse.getResultList();
    }

    @Override
    public ThirdPayBrief findByQingQingTradeNo(String qingqingTradeNo) {
        SingleResponse<ThirdPayBrief> payBriefDetailResponse =  apiPiClient.getThirdPayBriefDetail(qingqingTradeNo);

        return payBriefDetailResponse.getResultList();
    }

    public static void main(String[] args) {
        String s = "{\"response\":{\"error_code\":0,\"error_message\":\"\",\"hint_message\":\"\"},\"resultList\":[{\"id\":13521,\"studentId\":22367,\"userId\":22367,\"userType\":\"student\",\"relatedOrderId\":55384,\"relatedOrderType\":\"general_order_type\",\"qingqingTradeNo\":\"1536764053070T972076049406\",\"thirdPaymentTradeNo\":null,\"balanceAmount\":0.0,\"unWithdrawableBalanceAmount\":null,\"businessType\":\"qingqing\",\"thirdPaymentAmount\":48.0,\"thirdPaymentTypeV3\":\"alipayQingQingApp\",\"thirdPaymentId\":600709,\"payTime\":null,\"orderPayTime\":null,\"expireTime\":1536797100000,\"createTime\":1536764053000,\"lastUpdateTime\":1536764053000,\"tradeId\":\"10464\",\"remoteIp\":\"127.0.0.1\",\"installmentPoundagePrice\":0.0,\"stageNum\":null,\"installmentPoundageRate\":0.0,\"installmentPoundageConfigId\":null,\"paymentAccountNo\":null,\"totalThirdPaymentAmount\":48.0,\"totalPayAmount\":48.0},{\"id\":13522,\"studentId\":22367,\"userId\":22367,\"userType\":\"student\",\"relatedOrderId\":55384,\"relatedOrderType\":\"general_order_type\",\"qingqingTradeNo\":\"1536764370416T708322475150\",\"thirdPaymentTradeNo\":null,\"balanceAmount\":0.0,\"unWithdrawableBalanceAmount\":null,\"businessType\":\"qingqing\",\"thirdPaymentAmount\":48.0,\"thirdPaymentTypeV3\":\"alipayQingQingApp\",\"thirdPaymentId\":600710,\"payTime\":null,\"orderPayTime\":null,\"expireTime\":1536797100000,\"createTime\":1536764370000,\"lastUpdateTime\":1536764370000,\"tradeId\":\"10465\",\"remoteIp\":\"127.0.0.1\",\"installmentPoundagePrice\":0.0,\"stageNum\":null,\"installmentPoundageRate\":0.0,\"installmentPoundageConfigId\":null,\"paymentAccountNo\":null,\"totalThirdPaymentAmount\":48.0,\"totalPayAmount\":48.0},{\"id\":13523,\"studentId\":22367,\"userId\":22367,\"userType\":\"student\",\"relatedOrderId\":55384,\"relatedOrderType\":\"general_order_type\",\"qingqingTradeNo\":\"1536764598403T160713802904\",\"thirdPaymentTradeNo\":null,\"balanceAmount\":0.0,\"unWithdrawableBalanceAmount\":null,\"businessType\":\"qingqing\",\"thirdPaymentAmount\":48.0,\"thirdPaymentTypeV3\":\"alipayQingQingApp\",\"thirdPaymentId\":600711,\"payTime\":null,\"orderPayTime\":null,\"expireTime\":1536797100000,\"createTime\":1536764598000,\"lastUpdateTime\":1536764598000,\"tradeId\":\"10466\",\"remoteIp\":\"127.0.0.1\",\"installmentPoundagePrice\":0.0,\"stageNum\":null,\"installmentPoundageRate\":0.0,\"installmentPoundageConfigId\":null,\"paymentAccountNo\":null,\"totalThirdPaymentAmount\":48.0,\"totalPayAmount\":48.0},{\"id\":13524,\"studentId\":22367,\"userId\":22367,\"userType\":\"student\",\"relatedOrderId\":55384,\"relatedOrderType\":\"general_order_type\",\"qingqingTradeNo\":\"1536764648402T565250479816\",\"thirdPaymentTradeNo\":null,\"balanceAmount\":0.0,\"unWithdrawableBalanceAmount\":null,\"businessType\":\"qingqing\",\"thirdPaymentAmount\":48.0,\"thirdPaymentTypeV3\":\"alipayQingQingApp\",\"thirdPaymentId\":600712,\"payTime\":null,\"orderPayTime\":null,\"expireTime\":1536797100000,\"createTime\":1536764648000,\"lastUpdateTime\":1536764648000,\"tradeId\":\"10467\",\"remoteIp\":\"127.0.0.1\",\"installmentPoundagePrice\":0.0,\"stageNum\":null,\"installmentPoundageRate\":0.0,\"installmentPoundageConfigId\":null,\"paymentAccountNo\":null,\"totalThirdPaymentAmount\":48.0,\"totalPayAmount\":48.0},{\"id\":13525,\"studentId\":22367,\"userId\":22367,\"userType\":\"student\",\"relatedOrderId\":55384,\"relatedOrderType\":\"general_order_type\",\"qingqingTradeNo\":\"1536764792819T286133636645\",\"thirdPaymentTradeNo\":null,\"balanceAmount\":0.0,\"unWithdrawableBalanceAmount\":null,\"businessType\":\"qingqing\",\"thirdPaymentAmount\":48.0,\"thirdPaymentTypeV3\":\"alipayQingQingApp\",\"thirdPaymentId\":600713,\"payTime\":null,\"orderPayTime\":null,\"expireTime\":1536797100000,\"createTime\":1536764792000,\"lastUpdateTime\":1536764792000,\"tradeId\":\"10468\",\"remoteIp\":\"127.0.0.1\",\"installmentPoundagePrice\":0.0,\"stageNum\":null,\"installmentPoundageRate\":0.0,\"installmentPoundageConfigId\":null,\"paymentAccountNo\":null,\"totalThirdPaymentAmount\":48.0,\"totalPayAmount\":48.0},{\"id\":13526,\"studentId\":22367,\"userId\":22367,\"userType\":\"student\",\"relatedOrderId\":55384,\"relatedOrderType\":\"general_order_type\",\"qingqingTradeNo\":\"1536764898431T418528718984\",\"thirdPaymentTradeNo\":null,\"balanceAmount\":0.0,\"unWithdrawableBalanceAmount\":null,\"businessType\":\"qingqing\",\"thirdPaymentAmount\":48.0,\"thirdPaymentTypeV3\":\"alipayQingQingApp\",\"thirdPaymentId\":600714,\"payTime\":null,\"orderPayTime\":null,\"expireTime\":1536797100000,\"createTime\":1536764898000,\"lastUpdateTime\":1536764898000,\"tradeId\":\"10469\",\"remoteIp\":\"127.0.0.1\",\"installmentPoundagePrice\":0.0,\"stageNum\":null,\"installmentPoundageRate\":0.0,\"installmentPoundageConfigId\":null,\"paymentAccountNo\":null,\"totalThirdPaymentAmount\":48.0,\"totalPayAmount\":48.0},{\"id\":13527,\"studentId\":22367,\"userId\":22367,\"userType\":\"student\",\"relatedOrderId\":55384,\"relatedOrderType\":\"general_order_type\",\"qingqingTradeNo\":\"1536765304792T147554194864\",\"thirdPaymentTradeNo\":null,\"balanceAmount\":0.0,\"unWithdrawableBalanceAmount\":null,\"businessType\":\"qingqing\",\"thirdPaymentAmount\":48.0,\"thirdPaymentTypeV3\":\"alipayQingQingApp\",\"thirdPaymentId\":600715,\"payTime\":null,\"orderPayTime\":null,\"expireTime\":1536797100000,\"createTime\":1536765304000,\"lastUpdateTime\":1536765304000,\"tradeId\":\"10470\",\"remoteIp\":\"127.0.0.1\",\"installmentPoundagePrice\":0.0,\"stageNum\":null,\"installmentPoundageRate\":0.0,\"installmentPoundageConfigId\":null,\"paymentAccountNo\":null,\"totalThirdPaymentAmount\":48.0,\"totalPayAmount\":48.0},{\"id\":13528,\"studentId\":22367,\"userId\":22367,\"userType\":\"student\",\"relatedOrderId\":55384,\"relatedOrderType\":\"general_order_type\",\"qingqingTradeNo\":\"1536765463313T301755891250\",\"thirdPaymentTradeNo\":null,\"balanceAmount\":0.0,\"unWithdrawableBalanceAmount\":null,\"businessType\":\"qingqing\",\"thirdPaymentAmount\":48.0,\"thirdPaymentTypeV3\":\"alipayQingQingApp\",\"thirdPaymentId\":600716,\"payTime\":null,\"orderPayTime\":null,\"expireTime\":1536797100000,\"createTime\":1536765463000,\"lastUpdateTime\":1536765463000,\"tradeId\":\"10471\",\"remoteIp\":\"127.0.0.1\",\"installmentPoundagePrice\":0.0,\"stageNum\":null,\"installmentPoundageRate\":0.0,\"installmentPoundageConfigId\":null,\"paymentAccountNo\":null,\"totalThirdPaymentAmount\":48.0,\"totalPayAmount\":48.0},{\"id\":13529,\"studentId\":22367,\"userId\":22367,\"userType\":\"student\",\"relatedOrderId\":55384,\"relatedOrderType\":\"general_order_type\",\"qingqingTradeNo\":\"1536765527135T280428670381\",\"thirdPaymentTradeNo\":null,\"balanceAmount\":0.0,\"unWithdrawableBalanceAmount\":null,\"businessType\":\"qingqing\",\"thirdPaymentAmount\":48.0,\"thirdPaymentTypeV3\":\"alipayQingQingApp\",\"thirdPaymentId\":600717,\"payTime\":null,\"orderPayTime\":null,\"expireTime\":1536797100000,\"createTime\":1536765527000,\"lastUpdateTime\":1536765527000,\"tradeId\":\"10472\",\"remoteIp\":\"127.0.0.1\",\"installmentPoundagePrice\":0.0,\"stageNum\":null,\"installmentPoundageRate\":0.0,\"installmentPoundageConfigId\":null,\"paymentAccountNo\":null,\"totalThirdPaymentAmount\":48.0,\"totalPayAmount\":48.0},{\"id\":13530,\"studentId\":22367,\"userId\":22367,\"userType\":\"student\",\"relatedOrderId\":55384,\"relatedOrderType\":\"general_order_type\",\"qingqingTradeNo\":\"1536765569124T361772294340\",\"thirdPaymentTradeNo\":null,\"balanceAmount\":0.0,\"unWithdrawableBalanceAmount\":null,\"businessType\":\"qingqing\",\"thirdPaymentAmount\":48.0,\"thirdPaymentTypeV3\":\"alipayQingQingApp\",\"thirdPaymentId\":600718,\"payTime\":null,\"orderPayTime\":null,\"expireTime\":1536797100000,\"createTime\":1536765569000,\"lastUpdateTime\":1536765569000,\"tradeId\":\"10473\",\"remoteIp\":\"127.0.0.1\",\"installmentPoundagePrice\":0.0,\"stageNum\":null,\"installmentPoundageRate\":0.0,\"installmentPoundageConfigId\":null,\"paymentAccountNo\":null,\"totalThirdPaymentAmount\":48.0,\"totalPayAmount\":48.0},{\"id\":13531,\"studentId\":22367,\"userId\":22367,\"userType\":\"student\",\"relatedOrderId\":55384,\"relatedOrderType\":\"general_order_type\",\"qingqingTradeNo\":\"1536765608448T127172466812\",\"thirdPaymentTradeNo\":null,\"balanceAmount\":0.0,\"unWithdrawableBalanceAmount\":null,\"businessType\":\"qingqing\",\"thirdPaymentAmount\":48.0,\"thirdPaymentTypeV3\":\"alipayQingQingApp\",\"thirdPaymentId\":600719,\"payTime\":null,\"orderPayTime\":null,\"expireTime\":1536797100000,\"createTime\":1536765608000,\"lastUpdateTime\":1536765608000,\"tradeId\":\"10474\",\"remoteIp\":\"127.0.0.1\",\"installmentPoundagePrice\":0.0,\"stageNum\":null,\"installmentPoundageRate\":0.0,\"installmentPoundageConfigId\":null,\"paymentAccountNo\":null,\"totalThirdPaymentAmount\":48.0,\"totalPayAmount\":48.0},{\"id\":13532,\"studentId\":22367,\"userId\":22367,\"userType\":\"student\",\"relatedOrderId\":55384,\"relatedOrderType\":\"general_order_type\",\"qingqingTradeNo\":\"1536766017477T721481558494\",\"thirdPaymentTradeNo\":null,\"balanceAmount\":0.0,\"unWithdrawableBalanceAmount\":null,\"businessType\":\"qingqing\",\"thirdPaymentAmount\":48.0,\"thirdPaymentTypeV3\":\"alipayQingQingApp\",\"thirdPaymentId\":600720,\"payTime\":null,\"orderPayTime\":null,\"expireTime\":1536797100000,\"createTime\":1536766017000,\"lastUpdateTime\":1536766017000,\"tradeId\":\"10475\",\"remoteIp\":\"127.0.0.1\",\"installmentPoundagePrice\":0.0,\"stageNum\":null,\"installmentPoundageRate\":0.0,\"installmentPoundageConfigId\":null,\"paymentAccountNo\":null,\"totalThirdPaymentAmount\":48.0,\"totalPayAmount\":48.0}]}";
        ListResponse<ThirdPayBrief> result = JsonUtil.getObjectFromJson(s, ListResponse.class);
        System.out.println(JsonUtil.format(result));
    }
}
